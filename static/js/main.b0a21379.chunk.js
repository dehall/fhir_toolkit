(window.webpackJsonpfhir_toolkit=window.webpackJsonpfhir_toolkit||[]).push([[0],{159:function(e,t,a){e.exports=a(394)},164:function(e,t,a){},168:function(e,t,a){},184:function(e,t){},186:function(e,t){},218:function(e,t){},219:function(e,t){},287:function(e,t){},394:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),l=a(151),c=a.n(l),i=(a(164),a(152)),o=a(156),u=a(153),s=a(154),h=a(157),m=a(155),d=a(158),f=a(61),v=a.n(f);a(168);function y(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}var p=a(169),b=["Condition","Observation","Procedure"],E=window.localStorage,C=function(e){if(!e||!e.keys||0===e.keys.length)return null;var t=e.keys.map((function(e){return n.a.createElement("th",{scope:"col",key:e},e)})),a=e.data.map((function(t,a){return n.a.createElement("tr",{key:a},e.keys.map((function(e){return n.a.createElement("td",{key:e},t[e])})))}));return n.a.createElement("table",null,n.a.createElement("thead",null,n.a.createElement("tr",null,t)),n.a.createElement("tbody",null,a))},S=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(h.a)(this,Object(m.a)(t).call(this,e))).setStateAndLocalStorage=function(e){console.log(e),a.setState(e);for(var t=0,r=Object.entries(e);t<r.length;t++){var n=r[t],l=Object(o.a)(n,2),c=l[0],i=l[1];E.setItem(c,i)}},a.applyServerSettings=function(){a.setState({client:null});var e=a.fields.baseUrl.value;if(e&&e.trim()){E.setItem("baseUrl",e);var t=void 0;if(a.state.headerCount>0){t={};for(var r=0;r<a.state.headerCount;r++){var n="header_".concat(r,"_key"),l="header_".concat(r,"_value"),c=a.fields[n],i=a.fields[l];if(c&&i){var o=c.value,u=i.value;o&&u&&(t[o]=u,E.setItem(n,o),E.setItem(l,u))}}}fetch("".concat(e,"/metadata")).then((function(e){return e.json()}),(function(e){})).then((function(r){var n=p({baseUrl:e,headers:t});a.setStateAndLocalStorage({client:n,conformance:r})}))}},a.addHeader=function(){var e=a.state.headerCount+1;a.setStateAndLocalStorage({headerCount:e})},a.removeHeader=function(){var e=Math.max(0,a.state.headerCount-1);a.setStateAndLocalStorage({headerCount:e})},a.addSearchCriteria=function(){var e=a.state.searchCriteriaCount+1;a.setStateAndLocalStorage({searchCriteriaCount:e})},a.removeSearchCriteria=function(){var e=Math.max(1,a.state.searchCriteriaCount-1);a.setStateAndLocalStorage({searchCriteriaCount:e})},a.performSearch=function(){var e={};if(a.state.searchCriteriaCount>0)for(var t=0;t<a.state.searchCriteriaCount;t++){var r="criteria_".concat(t,"_key"),n="criteria_".concat(t,"_value"),l=a.fields[r],c=a.fields[n];if(l&&c){var i=l.value,o=c.value;i&&o&&(e[i]=o,E.setItem(r,i),E.setItem(n,o))}}a.state.client.search({type:"Patient",query:e}).then((function(e){return a.setState({searchResult:e.data})}),(function(e){return console.log(e)}))},a.selectPatientAction=function(e){return function(){a.setState({patientId:e}),a.queryPatientDetails(e)}},a.queryPatientDetails=function(e){var t=[],r=!0,n=!1,l=void 0;try{for(var c,i=b[Symbol.iterator]();!(r=(c=i.next()).done);r=!0){var o=c.value;console.log("starting query for "+o);var u=a.state.client.search({type:o,query:{patient:e}});t.push(u)}}catch(s){n=!0,l=s}finally{try{r||null==i.return||i.return()}finally{if(n)throw l}}Promise.all(t).then((function(e){var t={resourceType:"Bundle",entry:e.map((function(e){return e.data.entry})).flat()};a.setState({patient:t})}))},a.fields={},a.state=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?y(a,!0).forEach((function(t){Object(i.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):y(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},E,{client:null,baseUrl:E.getItem("baseUrl"),headerCount:Number(E.getItem("headerCount"))||0,searchCriteriaCount:Number(E.getItem("searchCriteriaCount"))||1}),a.state.baseUrl,a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"setRefFn",value:function(e){var t=this;return function(a){return t.fields[e]=a}}},{key:"renderHeaderFields",value:function(){for(var e=[],t=0;t<this.state.headerCount;t++){var a="header_".concat(t),r="".concat(a,"_key"),l="".concat(a,"_value");e.push(n.a.createElement("div",{key:a},n.a.createElement("label",{htmlFor:r},"Key"),n.a.createElement("input",{type:"text",name:r,defaultValue:this.state[r],ref:this.setRefFn(r)}),n.a.createElement("label",{htmlFor:l},"Value"),n.a.createElement("input",{type:"text",name:l,defaultValue:this.state[l],ref:this.setRefFn(l)}),n.a.createElement("br",null)))}return e}},{key:"createDropdown",value:function(e,t){var a=[];a.push(n.a.createElement("option",{key:"_",value:""}));var r=!0,l=!1,c=void 0;try{for(var i,o=e[Symbol.iterator]();!(r=(i=o.next()).done);r=!0){var u=i.value.name;a.push(n.a.createElement("option",{key:u,value:u},u))}}catch(s){l=!0,c=s}finally{try{r||null==o.return||o.return()}finally{if(l)throw c}}return n.a.createElement("select",{id:t,ref:this.setRefFn(t)}," ",a," ")}},{key:"renderSearchCriteria",value:function(e){if(!e||!e.rest||!e.rest[0])return null;for(var t=e.rest[0].resource.find((function(e){return"Patient"===e.type})).searchParam,a=[],r=0;r<this.state.searchCriteriaCount;r++){var l="criteria_".concat(r),c="".concat(l,"_key"),i="".concat(l,"_value"),o=n.a.createElement("div",{key:r},this.createDropdown(t,c),"=",n.a.createElement("input",{type:"text",name:i,ref:this.setRefFn(i)}),n.a.createElement("br",null));a.push(o)}return a}},{key:"renderSearchResults",value:function(e){if(!e||!e.entry)return null;var t=[],a=!0,r=!1,l=void 0;try{for(var c,i=e.entry[Symbol.iterator]();!(a=(c=i.next()).done);a=!0){var o=c.value.resource,u=o.name[0],s="".concat(u.family,", ").concat(u.given[0]);t.push(n.a.createElement("tr",{key:o.id},n.a.createElement("td",null,o.id),n.a.createElement("td",null,s),n.a.createElement("td",null,o.birthDate),n.a.createElement("td",null,n.a.createElement("button",{onClick:this.selectPatientAction(o.id)},"Select"))))}}catch(h){r=!0,l=h}finally{try{a||null==i.return||i.return()}finally{if(r)throw l}}return n.a.createElement("table",null,n.a.createElement("thead",null,n.a.createElement("tr",null,n.a.createElement("th",{scope:"col"},"ID"),n.a.createElement("th",{scope:"col"},"Name"),n.a.createElement("th",{scope:"col"},"Birthdate"),n.a.createElement("th",null,"Select"))),n.a.createElement("tbody",null,t))}},{key:"renderPatientDetails",value:function(e){if(e){var t,a=e.entry.map((function(e){return e.resource})),r=(t="resourceType",a.reduce((function(e,a){return(e[a[t]]=e[a[t]]||[]).push(a),e}),{}));return n.a.createElement("div",null,"Conditions",n.a.createElement("br",null),n.a.createElement(C,{keys:["resourceType","id"],data:r.Condition}),n.a.createElement("br",null),"Observations",n.a.createElement("br",null),n.a.createElement(C,{keys:["resourceType","id"],data:r.Observation}),n.a.createElement("br",null))}}},{key:"render",value:function(){var e=n.a.createElement("img",{src:"success.png",style:{height:"20px"}}),t=n.a.createElement("div",null,"Server Settings",this.state.client&&e),a=n.a.createElement("div",null,"Patient Search",this.state.patient&&e);return n.a.createElement("div",{className:"App"},n.a.createElement(v.a,{trigger:t,open:!this.state.client},n.a.createElement("label",{htmlFor:"baseUrl"},"Base URL:"),n.a.createElement("input",{type:"text",name:"baseUrl",id:"baseUrl",defaultValue:this.state.baseUrl,ref:this.setRefFn("baseUrl")}),n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement("label",null,"Request Headers"),n.a.createElement("br",null),this.renderHeaderFields(),n.a.createElement("button",{onClick:this.addHeader},"+"),n.a.createElement("button",{onClick:this.removeHeader},"-"),n.a.createElement("br",null),n.a.createElement("button",{onClick:this.applyServerSettings},"Apply and Connect")),n.a.createElement(v.a,{trigger:a,open:!!this.state.client&&!this.state.patientId},this.renderSearchCriteria(this.state.conformance),n.a.createElement("button",{onClick:this.addSearchCriteria},"+"),n.a.createElement("button",{onClick:this.removeSearchCriteria},"-"),n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement("button",{onClick:this.performSearch},"Search"),this.renderSearchResults(this.state.searchResult)),n.a.createElement(v.a,{trigger:"Patient Details",open:!!this.state.patientId},this.renderPatientDetails(this.state.patient)))}}]),t}(n.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(n.a.createElement(S,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[159,1,2]]]);
//# sourceMappingURL=main.b0a21379.chunk.js.map